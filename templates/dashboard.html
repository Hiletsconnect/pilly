{% extends "base.html" %}

{% block title %}Inicio - Pilly Cloud{% endblock %}
{% block page_title %}Inicio{% endblock %}
{% block page_description %}Resumen de tus pastilleros inteligentes y el estado del sistema{% endblock %}

{% block content %}
<!-- Stats Grid -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-label">Total de pastilleros</div>
        <div class="stat-value" id="total-devices">0</div>
        <div class="stat-change">Registrados en el sistema</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-label">En línea</div>
        <div class="stat-value" id="online-devices" style="color: var(--success-green);">0</div>
        <div class="stat-change positive">Activos ahora</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-label">Fuera de línea</div>
        <div class="stat-value" id="offline-devices" style="color: var(--error-red);">0</div>
        <div class="stat-change">Sin respuesta</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-label">Versiones de firmware</div>
        <div class="stat-value" id="total-releases">0</div>
        <div class="stat-change">Disponibles para OTA</div>
    </div>
    
    <div class="stat-card">
        <div class="stat-label">Tomas/alertas recientes</div>
        <div class="stat-value" id="recent-alarms" style="color: var(--warning-orange);">0</div>
        <div class="stat-change">Últimas 24 horas</div>
    </div>
</div>

<!-- Pastilleros recientes -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">Pastilleros recientes</h3>
        <a href="{{ url_for('devices') }}" class="btn btn-secondary btn-sm">Ver todos</a>
    </div>
    
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Pastillero</th>
                    <th>IP</th>
                    <th>Firmware</th>
                    <th>Estado</th>
                    <th>Última conexión</th>
                </tr>
            </thead>
            <tbody id="recent-devices-tbody">
                <tr>
                    <td colspan="5" class="text-center">
                        <div class="spinner" style="margin: 20px auto;"></div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<!-- Acciones rápidas -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">Acciones rápidas</h3>
    </div>
    
    <div class="flex gap-2">
        <a href="{{ url_for('devices') }}" class="btn btn-primary">
            <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
            </svg>
            Gestionar pastilleros
        </a>
        
        <a href="{{ url_for('releases') }}" class="btn btn-success">
            <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
            </svg>
            Subir firmware (OTA)
        </a>
        
        <a href="{{ url_for('alarms') }}" class="btn btn-secondary">
            <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
            </svg>
            Ver tomas/alertas
        </a>
    </div>
</div>

<!-- System Info -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">Info del sistema</h3>
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
        <div>
            <div style="font-size: 13px; color: var(--gray-500); margin-bottom: 8px;">Endpoint API</div>
            <div style="font-size: 14px; font-weight: 500; font-family: monospace; background: var(--gray-100); padding: 8px 12px; border-radius: 6px;">
                {{ request.url_root }}api/
            </div>
        </div>
        
        <div>
            <div style="font-size: 13px; color: var(--gray-500); margin-bottom: 8px;">Auto-actualización</div>
            <div style="font-size: 14px; font-weight: 500;">
                <span class="status-badge status-online">
                    <span class="status-dot"></span>
                    Activa (30s)
                </span>
            </div>
        </div>
        
        <div>
            <div style="font-size: 13px; color: var(--gray-500); margin-bottom: 8px;">Estado del sistema</div>
            <div style="font-size: 14px; font-weight: 500;">
                <span class="status-badge status-online">
                    <span class="status-dot"></span>
                    Operativo
                </span>
            </div>
        </div>
    </div>
</div>
{% endblock %}
